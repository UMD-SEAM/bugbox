if(window.addEventListener){window.addEventListener("load",table_init,false)}else{if(window.attachEvent){window.attachEvent("onload",table_init)}else{if(window.onload!=null){var old_onload=window.onload;window.onload=function(a){old_onload(a);table_init()}}else{window.onload=table_init}}}var SORT_COLUMN_INDEX;function table_init(){if(!document.getElementsByTagName){return}tables=document.getElementsByTagName("table");for(var a=0;a<tables.length;++a){if(hasClass(tables[a],"striped")){table_stripe(tables[a])}if(hasClass(tables[a],"sortable")&&tables[a].id){table_makeSortable(tables[a])}}}function table_stripe(e){var f=false;var b=e.childNodes;for(var g=0;g<b.length;++g){if(b[g].tagName!="TBODY"){continue}var a=b[g].childNodes;for(var d=0;d<a.length;++d){if(a[d].tagName=="TR"){removeClass(a[d],"rowEven");removeClass(a[d],"rowOdd");addClass(a[d],f?"rowEven":"rowOdd");f=!f}}}}function table_makeSortable(c){if(c.rows&&c.rows.length>0){var d=c.rows[0]}if(!d){return}for(var b=0;b<d.cells.length;++b){var a=d.cells[b];if(hasClass(a,"nosort")){continue}a.columnIndex=b;a.style.cursor="pointer";a.onclick=function(f){var f=f||window.event;if(f.target){if(f.target.nodeType==3){f.target=f.target.parentNode}}else{if(f.srcElement){f.target=f.srcElement}}el=hasParent(f.target,"A","TH");if(el&&!hasClass(el,"sortlink")){return true}table_resortTable(getParent(f.target,"TH"));return false}}}function table_getSortValue(d){if(typeof d=="string"){return d.replace(/^\s+/,"").replace(/\s+$/,"")}if(typeof d=="undefined"){return d}if((d.hasAttribute&&d.hasAttribute("sortval"))||typeof d.sortval!="undefined"){return d.getAttribute("sortval")}if(d.innerText){return d.innerText.replace(/^\s+/,"").replace(/\s+$/,"")}var e="";var c=d.childNodes;var a=c.length;for(var b=0;b<a;++b){switch(c[b].nodeType){case 1:e+=table_getSortValue(c[b]);break;case 3:e+=c[b].nodeValue;break}}return e.replace(/^\s+/,"").replace(/\s+$/,"")}function table_resortTable(c){table=getParent(c,"TABLE");sortColumn=c.columnIndex;sortDown=0;theads=table.tHead.getElementsByTagName("th");for(var b=0;b<theads.length;++b){if(c==theads[b]){if(hasClass(theads[b],"sortup")){removeClass(theads[b],"sortup");addClass(theads[b],"sortdown")}else{if(hasClass(theads[b],"sortdown")){removeClass(theads[b],"sortdown");addClass(theads[b],"sortup");sortDown=1}else{addClass(theads[b],"sortdown")}}}else{removeClass(theads[b],"sortup");removeClass(theads[b],"sortdown")}}if(table.rows.length<=1){return}var d=table_getSortValue(table.rows[1].cells[sortColumn]);sortfn=table_sort_caseinsensitive;if(d.match(/^\d\d[\/\.-]\d\d[\/\.-]\d\d(\d\d)?$/)){sortfn=table_sort_date}else{if(d.match(/^[£$€¥]/)){sortfn=table_sort_currency}else{if(d.match(/^[\d\.]+$/)){sortfn=table_sort_numeric}}}SORT_COLUMN_INDEX=sortColumn;for(var b=0;b<table.tBodies.length;++b){trs=table.tBodies[b].getElementsByTagName("tr");newRows=[];for(var a=0;a<trs.length;++a){newRows[a]=trs[a]}newRows.sort(sortfn);if(sortDown){newRows.reverse()}for(var a=0;a<newRows.length;++a){if(!hasClass(newRows[a],"sortbottom")){table.tBodies[b].appendChild(newRows[a])}}for(var a=0;a<newRows.length;++a){if(hasClass(newRows[a],"sortbottom")){table.tBodies[b].appendChild(newRows[a])}}}if(hasClass(table,"striped")){table_stripe(table)}if(typeof(table_sortCallback)=="function"){table_sortCallback(table.id,c.id,sortDown)}}function getParent(b,a){if(b==null){return null}else{if(a==null){return b.parentNode}else{if(b.nodeType==1&&b.tagName.toLowerCase()==a.toLowerCase()){return b}else{return getParent(b.parentNode,a)}}}}function table_sort_date(d,c){aa=table_getSortValue(d.cells[SORT_COLUMN_INDEX]);bb=table_getSortValue(c.cells[SORT_COLUMN_INDEX]);if(aa.length==10){dt1=aa.substr(6,4)+aa.substr(3,2)+aa.substr(0,2)}else{yr=aa.substr(6,2);if(parseInt(yr)<50){yr="20"+yr}else{yr="19"+yr}dt1=yr+aa.substr(3,2)+aa.substr(0,2)}if(bb.length==10){dt2=bb.substr(6,4)+bb.substr(3,2)+bb.substr(0,2)}else{yr=bb.substr(6,2);if(parseInt(yr)<50){yr="20"+yr}else{yr="19"+yr}dt2=yr+bb.substr(3,2)+bb.substr(0,2)}if(dt1==dt2){return 0}else{if(dt1<dt2){return-1}}return 1}function table_sort_currency(d,c){aa=table_getSortValue(d.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,"");bb=table_getSortValue(c.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,"");return parseFloat(aa)-parseFloat(bb)}function table_sort_numeric(d,c){aa=parseFloat(table_getSortValue(d.cells[SORT_COLUMN_INDEX]));if(isNaN(aa)){aa=0}bb=parseFloat(table_getSortValue(c.cells[SORT_COLUMN_INDEX]));if(isNaN(bb)){bb=0}return aa-bb}function table_sort_caseinsensitive(d,c){aa=table_getSortValue(d.cells[SORT_COLUMN_INDEX]).toLowerCase();bb=table_getSortValue(c.cells[SORT_COLUMN_INDEX]).toLowerCase();if(aa==bb){return 0}else{if(aa<bb){return-1}}return 1}function table_sort_default(d,c){aa=table_getSortValue(d.cells[SORT_COLUMN_INDEX]);bb=table_getSortValue(c.cells[SORT_COLUMN_INDEX]);if(aa==bb){return 0}else{if(aa<bb){return-1}}return 1}function hasParent(c,a,b){if(c.tagName==a){return c}else{if(b!=null&&c.tagName==b){return false}else{return hasParent(getParent(c),a,b)}}}function addClass(b,a){b.className+=b.className?" "+a:a}function removeClass(b,a){b.className=b.className.replace(new RegExp(" ?"+a+" ?"),"")}function hasClass(b,a){return(b.className.indexOf(a)!=-1)};